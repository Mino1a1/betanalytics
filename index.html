<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>iBet Analytics</title>
    
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/6556/6556100.png">
    <meta name="apple-mobile-web-app-title" content="iBet Pro">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica; -webkit-tap-highlight-color: transparent; }
        .ios-blur { backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); background: rgba(255,255,255,0.8); }
        .tab-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 85px; border-top: 0.5px solid #d1d1d1; padding-bottom: 20px; }
        .selected-bet { background-color: #007AFF !important; color: white !important; border-color: #007AFF !important; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#F2F2F7] pb-40">

    <div class="sticky top-0 z-20 bg-[#F2F2F7]/95 backdrop-blur-md p-5 pb-2">
        <h1 class="text-3xl font-extrabold tracking-tight mb-3">Scommesse</h1>
        <div class="bg-gray-200/50 rounded-xl flex items-center p-2 px-3">
            <i class="fa-solid fa-magnifying-glass text-gray-400 mr-2 text-sm"></i>
            <input type="text" id="search" placeholder="Cerca squadra o campionato..." class="bg-transparent w-full outline-none text-md">
        </div>
        
        <div class="flex space-x-3 mt-4 overflow-x-auto no-scrollbar pb-2">
            <button class="bg-black text-white px-4 py-1.5 rounded-full text-xs font-bold">Tutti</button>
            <button class="bg-white border border-gray-200 px-4 py-1.5 rounded-full text-xs font-bold">Serie A</button>
            <button class="bg-white border border-gray-200 px-4 py-1.5 rounded-full text-xs font-bold">Premier</button>
            <button class="bg-white border border-gray-200 px-4 py-1.5 rounded-full text-xs font-bold">La Liga</button>
        </div>
    </div>

    <main id="matchList" class="p-4 space-y-4">
        </main>

    <div id="slip" class="fixed bottom-24 left-4 right-4 bg-white rounded-3xl shadow-2xl p-5 transform transition-all translate-y-full opacity-0">
        <div class="flex justify-between items-start mb-2">
            <div>
                <h3 class="font-bold text-lg text-blue-600">Analisi Schedina</h3>
                <p id="advice" class="text-[10px] text-gray-400 italic max-w-[200px] leading-tight"></p>
            </div>
            <div class="text-right">
                <span id="totalOdds" class="text-xs bg-gray-100 px-2 py-1 rounded-md font-mono">Quota: 1.00</span>
            </div>
        </div>
        <div class="flex justify-between items-end mt-4">
            <div>
                <p class="text-xs text-gray-500 uppercase font-bold">Probabilità Vincita</p>
                <p id="probVal" class="text-3xl font-black text-black">0%</p>
            </div>
            <button class="bg-[#007AFF] text-white px-6 py-3 rounded-2xl font-bold shadow-lg shadow-blue-200">Gioca</button>
        </div>
    </div>

    <nav class="tab-bar ios-blur flex justify-around items-center z-30">
        <div class="flex flex-col items-center text-[#007AFF]"><i class="fa-solid fa-house text-xl"></i><span class="text-[10px] mt-1">Home</span></div>
        <div class="flex flex-col items-center text-gray-400"><i class="fa-solid fa-chart-simple text-xl"></i><span class="text-[10px] mt-1">Statistiche</span></div>
        <div class="flex flex-col items-center text-gray-400"><i class="fa-solid fa-receipt text-xl"></i><span class="text-[10px] mt-1">Le mie giocate</span></div>
        <div class="flex flex-col items-center text-gray-400"><i class="fa-solid fa-user text-xl"></i><span class="text-[10px] mt-1">Profilo</span></div>
    </nav>

    <script>
        const matches = [
            { id: 1, league: 'Serie A', home: 'Inter', away: 'Milan', odds: { '1': 1.85, 'X': 3.40, '2': 4.20, '1X': 1.22, 'X2': 1.95, 'GG': 1.65, 'NG': 2.10, 'O2.5': 1.75, 'U2.5': 2.00 } },
            { id: 2, league: 'Premier League', home: 'Arsenal', away: 'Liverpool', odds: { '1': 2.30, 'X': 3.50, '2': 3.00, '1X': 1.38, 'X2': 1.62, 'GG': 1.55, 'NG': 2.30, 'O2.5': 1.60, 'U2.5': 2.25 } }
        ];

        let selectedBets = [];

        function renderMatches() {
            const list = document.getElementById('matchList');
            list.innerHTML = matches.map(m => `
                <div class="bg-white rounded-[25px] p-5 shadow-sm border border-gray-100">
                    <div class="flex justify-between text-[10px] font-bold text-gray-400 mb-3">
                        <span>${m.league.toUpperCase()}</span>
                        <span class="text-green-500">LIVE</span>
                    </div>
                    <div class="flex justify-between items-center mb-5">
                        <span class="font-bold text-lg">${m.home}</span>
                        <span class="text-gray-300">vs</span>
                        <span class="font-bold text-lg">${m.away}</span>
                    </div>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                        ${['1','X','2'].map(res => `<button onclick="toggleBet(${m.id}, '${res}', ${m.odds[res]}, this)" class="bg-gray-50 py-3 rounded-xl border border-gray-50 transition-all active:scale-95"><span class="block text-[9px] text-gray-400 font-bold">${res}</span><span class="font-bold">${m.odds[res]}</span></button>`).join('')}
                    </div>
                    <div class="grid grid-cols-4 gap-2">
                        ${['1X','X2','GG','O2.5'].map(res => `<button onclick="toggleBet(${m.id}, '${res}', ${m.odds[res]}, this)" class="bg-blue-50/50 py-2 rounded-lg text-xs font-bold text-blue-600 transition-all active:scale-95">${res} ${m.odds[res]}</button>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        function toggleBet(matchId, label, odd, el) {
            const betKey = `${matchId}-${label}`;
            const index = selectedBets.findIndex(b => b.key === betKey);
            
            if (index > -1) {
                selectedBets.splice(index, 1);
                el.classList.remove('selected-bet');
            } else {
                selectedBets.push({ key: betKey, matchId, odd });
                el.classList.add('selected-bet');
            }
            updateSlip();
        }

        function updateSlip() {
            const slip = document.getElementById('slip');
            if (selectedBets.length > 0) {
                slip.classList.remove('translate-y-full', 'opacity-0');
                
                let totalOdd = selectedBets.reduce((acc, b) => acc * b.odd, 1);
                // Calcolo probabilità reale con margine banco
                let prob = (1 / totalOdd) * 100 * Math.pow(0.92, selectedBets.length);
                
                document.getElementById('totalOdds').innerText = `Quota: ${totalOdd.toFixed(2)}`;
                document.getElementById('probVal').innerText = `${prob.toFixed(1)}%`;
                
                let advice = prob < 15 ? "⚠️ Rischio alto: prova a coprirti con una Doppia Chance (1X)." : "✅ Schedina ben bilanciata.";
                if (selectedBets.length > 4) advice = "❗ Troppi eventi: la probabilità crolla. Riduci a 3.";
                document.getElementById('advice').innerText = advice;

            } else {
                slip.classList.add('translate-y-full', 'opacity-0');
            }
        }

        renderMatches();
    </script>
</body>
</html>